<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="assets/icons/icon-192.png" />
    <meta name="theme-color" content="#007BFF" />
    <title>Calculadora Financeira</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="manifest" href="manifest.json" />
    
    <!-- Enviar email via EmailJS-->
    <script>
      (function () {
        emailjs.init("1Ro3I9ZseyDAc6RTM"); // substitui pelo teu public key
      })();
    </script>

    <!--Firebase-->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  </head>
  <body>
    <!-- SCREEN 1 -->
    <div id="screen1" class="screen">
      <h1>Bem-vindo √† Calculadora de Lucros</h1>
      <h2>feito por Ant√≥nio Appleton</h2>
      <button onclick="goToScreen2()">Come√ßar</button>
    </div>

    <!-- SCREEN 2 -->
    <div id="screen2" class="screen hidden">
      <div
        class="explanation"
        style="
          margin-bottom: 4px;
          padding: 10px;
          border: 1px solid #090909;
          border-radius: 5px;
          background: #fffcfc;
        "
      >
        <h3 style="margin: 10px 0 2px 0">TP1 (Target Price 1):</h3>
        <h6 style="margin: 0 0 8px 0; font-weight: normal">
          Pre√ßo atual ou inicial da a√ß√£o. √â o ponto de partida para os c√°lculos
          de valoriza√ß√£o e investimento.
        </h6>

        <h3 style="margin: 10px 0 2px 0">TP2 (Target Price 2):</h3>
        <h6 style="margin: 0 0 8px 0; font-weight: normal">
          Pre√ßo futuro da a√ß√£o. √â o ponto de chegada para os c√°lculos de
          valoriza√ß√£o e investimento.
        </h6>

        <h3 style="margin: 10px 0 2px 0">Dividendos:</h3>
        <h6 style="margin: 0 0 8px 0; font-weight: normal">
          Valor que a Empresa paga por cada Stock que √© detida, que ser√° somado
          ao lucro total.
        </h6>
      </div>

      <h2>Escolhe uma op√ß√£o:</h2>
      <div class="buttons-grid">
        <button onclick="abrirSecao(1)">üìà Lucro Esperado</button>
        <button onclick="abrirSecao(2)">üìä Quanto tens de Investir</button>
        <button onclick="abrirSecao(3)">üìà Lucro % de crescimento</button>
        <button onclick="abrirSecao(4)">
          üìä Tens de Investir a % de Crescimento
        </button>
        <button onclick="abrirSecao(5)">üìä Simulador</button>
        <button onclick="abrirSecao(6)">üìÖ Base Dados das Tuas Stocks</button>
      </div>
      <div class="buttons">
        <button onclick="goToScreen1()">Voltar</button>
      </div>
    </div>

    <!-- SEC√á√ÉO 1 -->
    <div id="sec1Screen" class="screen hidden">
      <div class="section">
        <div class="section-header">
          <h4>1. Calcular Lucro com TP1, TP2, Investimento e Dividendos.</h4>
          <button class="info-toggle" onclick="toggleInfo('info1')">
            ‚ÑπÔ∏è +info
          </button>
        </div>
        <div class="info-text" id="info1">
          <h5>
            Introduz o pre√ßo inicial da a√ß√£o (TP1), o pre√ßo esperado no futuro
            (TP2), o valor que vais investir e os dividendos esperados. O
            resultado ser√° o lucro total esperado.
          </h5>
        </div>
        <label
          >Pre√ßo Inicial (TP1): <input type="number" id="tp1_1" step="0.01"
        /></label>
        <label
          >Pre√ßo Final (TP2): <input type="number" id="tp2_1" step="0.01"
        /></label>
        <label
          >Valor Investido: <input type="number" id="invest_1" step="0.01"
        /></label>
        <label
          >Dividendo por a√ß√£o:
          <input type="number" id="dividendo_1" step="0.01"
        /></label>
        <p>Lucro valoriza√ß√£o: <span id="lucro_valorizacao1">-</span></p>
        <p>
          Lucro total (incluindo dividendos): <span id="lucro_total1">-</span>
        </p>
        <button onclick="calcularLucro1()">Calcular</button>
      </div>
      <div class="buttons">
        <button onclick="limparCampos()">Apagar Tudo</button>
        <button onclick="voltarMenu()">Voltar ao Menu</button>
      </div>
    </div>

    <!-- SEC√á√ÉO 2 -->
    <div id="sec2Screen" class="screen hidden">
      <div class="section">
        <div class="section-header">
          <h4>2. Calcular Valor a Investir com TP1, TP2, Lucro Desejado.</h4>
          <button class="info-toggle" onclick="toggleInfo('info2')">
            ‚ÑπÔ∏è +info
          </button>
        </div>
        <div class="info-text" id="info2">
          <h5>
            Introduz o pre√ßo inicial (TP1), o pre√ßo futuro esperado (TP2) e o
            lucro desejado. O resultado ser√° o valor que precisas investir para
            atingir esse lucro.
          </h5>
        </div>
        <label
          >Pre√ßo Inicial (TP1): <input type="number" id="tp1_2" step="0.01"
        /></label>
        <!--teste <label>Pre√ßo Final (TP2): <input type="number" id="tp2_2" step="0.01" /></label> -->
        <label
          >Pre√ßo Final (TP2):
          <input
            type="number"
            id="tp2_2"
            step="0.01"
            oninput="atualizarTP2_2()"
          />
          % Crescimento: <span id="percent_2">-</span></label
        >
        <label
          >Lucro Desejado: <input type="number" id="lucro_2" step="0.01"
        /></label>
        <p>Investimento necess√°rio: <span id="invest2">-</span></p>
        <button onclick="calcularInvestimento2()">Calcular</button>
      </div>
      <div class="buttons">
        <button onclick="limparCampos()">Apagar Tudo</button>
        <button onclick="voltarMenu()">Voltar ao Menu</button>
      </div>
    </div>

    <!-- SEC√á√ÉO 3 -->
    <div id="sec3Screen" class="screen hidden">
      <div class="section">
        <div class="section-header">
          <h4>
            3. Calcular Lucro com TP1, % Crescimento, Investimento e Dividendos.
          </h4>
          <button class="info-toggle" onclick="toggleInfo('info3')">
            ‚ÑπÔ∏è +info
          </button>
        </div>
        <div class="info-text" id="info3">
          <h5>
            Introduz o pre√ßo inicial (TP1), a percentagem de crescimento
            esperada, o valor que vais investir e os dividendos esperados. O
            resultado ser√° o lucro total esperado.
          </h5>
        </div>
        <label
          >Pre√ßo Inicial (TP1): <input type="number" id="tp1_3" step="0.01"
        /></label>
        <label
          >% Crescimento: <input type="number" id="percent_3" step="0.01"
        /></label>
        <label
          >Valor Investido: <input type="number" id="invest_3" step="0.01"
        /></label>
        <label
          >Dividendo por a√ß√£o:
          <input type="number" id="dividendo_3" step="0.01"
        /></label>
        <p>Lucro valoriza√ß√£o: <span id="lucro_valorizacao3">-</span></p>
        <p>
          Lucro total (incluindo dividendos): <span id="lucro_total3">-</span>
        </p>
        <button onclick="calcularLucro3()">Calcular</button>
      </div>
      <div class="buttons">
        <button onclick="limparCampos()">Apagar Tudo</button>
        <button onclick="voltarMenu()">Voltar ao Menu</button>
      </div>
    </div>

    <!-- SEC√á√ÉO 4 -->
    <div id="sec4Screen" class="screen hidden">
      <div class="section">
        <div class="section-header">
          <h4>
            4. Calcular Valor a Investir com TP1, % Crescimento, Lucro Desejado.
          </h4>
          <button class="info-toggle" onclick="toggleInfo('info4')">
            ‚ÑπÔ∏è +info
          </button>
        </div>
        <div class="info-text" id="info4">
          <h5>
            Introduz o pre√ßo inicial (TP1), a percentagem de crescimento
            esperada e o lucro desejado. O resultado ser√° o valor que precisas
            investir.
          </h5>
        </div>
        <label
          >Pre√ßo Inicial (TP1):
          <input
            type="number"
            id="tp1_4"
            step="0.01"
            oninput="atualizarTP2_4()"
        /></label>
        <label
          >% Crescimento:
          <input
            type="number"
            id="percent_4"
            step="0.01"
            oninput="atualizarTP2_4()"
          />
          TP2: <span id="tp2_4">-</span></label
        >
        <label
          >Lucro Desejado: <input type="number" id="lucro_4" step="0.01"
        /></label>
        <p>Investimento necess√°rio: <span id="invest4">-</span></p>
        <button onclick="calcularInvestimento4()">Calcular</button>
      </div>
      <div class="buttons">
        <button onclick="limparCampos()">Apagar Tudo</button>
        <button onclick="voltarMenu()">Voltar ao Menu</button>
      </div>
    </div>

    <!-- SEC√á√ÉO Simula√ß√£o -->
    <div id="sec5Screen" class="screen hidden">
      <div class="section">
        <div class="section-header">
          <h4>Screen Simula√ß√£o Lucros.</h4>
        </div>
        <div class="info-text" id="info5">
          <h5>
            Simula√ß√£o de Lucros entre duas ou mais potenciais Ac√µes, com
            gr√°ficos ilustrativos
          </h5>
        </div>
        <div class="formulario">
          <input type="text" id="nomeAcao" placeholder="Nome da A√ß√£o" />
          <input type="number" id="tp1" placeholder="TP1" />
          <input type="number" id="tp2" placeholder="TP2" />
          <input
            type="number"
            id="investimento"
            placeholder="Valor Investido (‚Ç¨)"
          />
          <button onclick="simularEGUardar()">Simular e Guardar</button>
        </div>
        <h2>Tabela de Simula√ß√µes</h2>

        <div class="tabela-wrapper">
          <table id="tabelaSimulacoes">
            <thead>
              <tr>
                <th>A√ß√£o</th>
                <th>TP1</th>
                <th>TP2</th>
                <th>Investido</th>
                <th>Lucro</th>
                <th>% Crescimento</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <!-- Bot√£o Limpar-->
        <div class="grafico-wrapper">
          <canvas id="graficoLucro" width="400" height="200"></canvas>
          <button onclick="limparGrafico()">Limpar Gr√°ficoüóëÔ∏è</button>
        </div>
        <!-- Fim do bot√£o Limpar-->
      </div>
      <div class="buttons">
        <button onclick="limparCampos()">Apagar Tudo</button>
        <button onclick="voltarMenu()">Voltar ao Menu</button>

        <!-- Bot√£o para abrir o popup -->
        <button onclick="abrirPopupEmail()">Enviar Simula√ß√£o por Email</button>

        <!-- Popup -->
        <div id="popupEmail" class="hidden">
          <h3>Enviar Simula√ß√£o</h3>

          <div id="dadosSimulacao"></div>

          <div class="email-form">
            <input
              type="email"
              id="emailDestino"
              placeholder="Email de destino"
              required
            />
          </div>

          <div class="botoes-popup">
            <button onclick="enviarEmail()">Enviar</button>
            <button onclick="fecharPopupEmail()">Cancelar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- SEC√á√ÉO 6: Registo e Filtro de A√ß√µes -->
<div id="sec6Screen" class="screen hidden">
  <!-- REGISTO -->
  <div class="section">
    <h3>üìã Registar A√ß√£o com Dividendos</h3>
    <div class="form-grid">
      <input type="text" id="nomeAcaoReg" placeholder="Nome da A√ß√£o" />
      <input type="text" id="tickerAcaoReg" placeholder="Ticker" />
      <select id="Setor" placeholder="Setor" >
        <option value="">Seleciona o Setor</option>
        <option value="Energia">Energia</option>
        <option value="Consumo Defensivo">Consumo Defensivo</option>
        <option value="Materiais">Materiais</option>
        <option value="Industria">Industria</option>
        <option value="Tecnologia">Tecnologia</option>
        <option value="Sa√∫de">Sa√∫de</option>
        <option value="Imobili√°rio">Imobili√°rio</option>
        <option value="Finan√ßas">Finan√ßas</option>
      </select>
      <select id="Mercado" placeholder="Mercado" >
        <option value="">Seleciona o Mercado</option>
        <option value="PT">Portugal</option>
        <option value="EU">Europeu</option>
        <option value="USA">Americano</option>
        <option value="USAsp500">Americano (SP500)</option>
      </select>
      <input type="number" id="valorDividendoReg" step="0.01" placeholder="Valor do Dividendo (‚Ç¨)"/>
      <select id="mesDividendoReg">
        <option value="">Seleciona o m√™s</option>
        <option value="Janeiro">Janeiro</option>
        <option value="Fevereiro">Fevereiro</option>
        <option value="Mar√ßo">Mar√ßo</option>
        <option value="Abril">Abril</option>
        <option value="Maio">Maio</option>
        <option value="Junho">Junho</option>
        <option value="Julho">Julho</option>
        <option value="Agosto">Agosto</option>
        <option value="Setembro">Setembro</option>
        <option value="Outubro">Outubro</option>
        <option value="Novembro">Novembro</option>
        <option value="Dezembro">Dezembro</option>
      </select>
      <select id="periodicidade" placeholder="Periodicidade" >
        <option value="">Seleciona a Frequ√™ncia</option>
        <option value="Anual">Anual</option>
        <option value="Semestral">Semestral</option>
        <option value="Trimestral">Trimestral</option>
        <option value="Mensal">Mensal</option>
      </select>
    </div>
    <div class="buttons">
      <button onclick="guardarOuAtualizarAcaoFirebase()">üíæ Guardar / Atualizar</button>
    </div>
  </div>

  <!-- FILTROS -->
  <div class="section">
    <div class="section-header">
      <h4>üîç Filtrar A√ß√µes</h4>
      <button id="btnMostrarFiltros" onclick="toggleFiltrosMes()">‚ñº</button>
    </div>

    <div id="filtrosMesContainer" class="hidden">
      <div class="filtros-container">
  <label>
    <select id="filtroSetor">
      <option value="">Selecione um Setor</option>
      <option value="ETF">ETF's</option>
      <option value="Sa√∫de">Sa√∫de</option>
      <option value="ConsumoCiclico">Consumo C√≠clico</option>
      <option value="Tecnologia">Tecnologia</option>
      <option value="Financas">Finan√ßas</option>
      <option value="Materiais">Materiais</option>
      <option value="Energia">Energia</option>
      <option value="Defesa">Defesa</option>
      <option value="Industria">Ind√∫stria</option>
      <option value="ConsumoDefensivo">Consumo Defensivo</option>
      <option value="Imobili√°rio">Imobili√°rio</option>
    </select>
  </label>
  <label>
    <select id="filtroPeriodicidade"> <!-- ‚úÖ CORRIGIDO -->
      <option value="">Selecione a Periodicidade</option>
      <option value="Mensal">Mensal</option>
      <option value="Trimestral">Trimestral</option>
      <option value="Semestral">Semestral</option>
      <option value="Anual">Anual</option>
    </select>
    <select id="filtroMercado">
      <option value="">Selecione um Mercado</option>
      <option value="PT">Portugal</option>
      <option value="EU">Europa</option>
      <option value="USA">Estados Unidos</option>
      <option value="USAsp500">EUA (SP500)</option>
    </select>
  </label>
  <label>
    <select id="filtroMes">
      <option value="">Selecione um M√™s</option>
      <option value="Janeiro">Janeiro</option>
      <option value="Fevereiro">Fevereiro</option>
      <option value="Mar√ßo">Mar√ßo</option>
      <option value="Abril">Abril</option>
      <option value="Maio">Maio</option>
      <option value="Junho">Junho</option>
      <option value="Julho">Julho</option>
      <option value="Agosto">Agosto</option>
      <option value="Setembro">Setembro</option>
      <option value="Outubro">Outubro</option>
      <option value="Novembro">Novembro</option>
      <option value="Dezembro">Dezembro</option>
    </select>
  </label>
</div>

      <div class="buttons">
        <button onclick="filtrarAcoes()">üîé Aplicar Filtros</button>
      </div>
    </div>

    <div id="resultadoFiltroMes" class="resultado-acoes"></div>
  </div>
  <div class="buttons">
        <button onclick="voltarMenu()">Voltar ao Menu</button>
      </div>
    </div>
</div>


    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </body>
</html>
